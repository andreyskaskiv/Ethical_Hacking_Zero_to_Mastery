from vulnerability_scanner import Scanner


def run_scaner(target_links,
               target_forms_xss_to_write,
               target_links_xss_to_write,
               target_forms_command_exec_to_write,
               target_forms_html_injection_to_write,
               target_forms_sql_injection_to_write,
               target_forms_csrf_injection_to_write,
               ):
    vulnerability_scanner = Scanner(TARGET_URL, LINKS_TO_IGNORE)
    vulnerability_scanner.login(LOGIN_URL, AUTHORIZATION_IN_LOGIN_FORM)

    print("\033[1;32m\nCrawler Starts 🧐 ==> \033[0m")
    vulnerability_scanner.crawl()

    print("\033[1;32m\nVulnerability Scanner Starts 🧐 ==> \033[0m")
    vulnerability_scanner.run_scanner()

    vulnerability_scanner.write_target_links(target_links)
    vulnerability_scanner.write_target_forms_xss(target_forms_xss_to_write)
    vulnerability_scanner.write_target_links_xss(target_links_xss_to_write)
    vulnerability_scanner.write_target_forms_command_exec(target_forms_command_exec_to_write)
    vulnerability_scanner.write_target_forms_html_injection(target_forms_html_injection_to_write)
    vulnerability_scanner.write_target_forms_sql_injection(target_forms_sql_injection_to_write)
    vulnerability_scanner.write_target_forms_csrf_injection(target_forms_csrf_injection_to_write)


if __name__ == '__main__':
    TARGET_URL = "http://10.0.2.12/dvwa/"
    LOGIN_URL = f"{TARGET_URL}/login.php"

    LINKS_TO_IGNORE = [
        'http://10.0.2.12/dvwa/logout.php'
    ]

    AUTHORIZATION_IN_LOGIN_FORM = {
        "username": 'admin',
        "password": 'password',
        "Login": 'submit',
    }

    TARGET_LINKS_TO_WRITE = "target_LINKS_success"
    TARGET_FORMS_XSS_TO_WRITE = "target_forms_XSS_success"
    TARGET_LINKS_XSS_TO_WRITE = "target_links_XSS_success"
    TARGET_FORMS_COMMAND_EXEC_TO_WRITE = "target_forms_COMMAND_EXEC_success"
    TARGET_FORMS_HTML_INJECTION_TO_WRITE = "target_forms_HTML_INJECTION_success"
    TARGET_FORMS_SQL_INJECTION_TO_WRITE = "target_forms_SQL_INJECTION_success"
    TARGET_FORMS_CSRF_INJECTION_TO_WRITE = "target_forms_CSRF_INJECTION_success"

    run_scaner(
        TARGET_LINKS_TO_WRITE,
        TARGET_FORMS_XSS_TO_WRITE,
        TARGET_LINKS_XSS_TO_WRITE,
        TARGET_FORMS_COMMAND_EXEC_TO_WRITE,
        TARGET_FORMS_HTML_INJECTION_TO_WRITE,
        TARGET_FORMS_SQL_INJECTION_TO_WRITE,
        TARGET_FORMS_CSRF_INJECTION_TO_WRITE,
    )
