import re
import subprocess
from typing import List


def search_exploits(software: str, platform: str) -> List[str]:
    """Search for Metasploit exploits based on the specified software."""

    command = f"msfconsole -q -x \"search type:exploit {software} platform:{platform}; exit\""

    result = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT).decode('utf-8')

    pattern = re.compile(r'exploit/[^ ]+')
    exploits = pattern.findall(result)

    return exploits


def get_exploits(software: str, platform: str):
    exploits = search_exploits(software, platform)

    for exploit in exploits:
        print(exploit)


if __name__ == '__main__':
    soft_ware = "ssh"
    platform = "windows"  # aix, linux, multi, unix, windows, solaris, netware, android, ...
    get_exploits(soft_ware, platform)
